<!-- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ç”»é¢ -->
<div class="project-list">
  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <div class="project-list__header">
    <h1 class="project-list__title">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</h1>
    <button type="button" class="project-list__create-btn" (click)="openCreateDialog()">
      æ–°è¦ä½œæˆ
    </button>
  </div>

  <!-- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° -->
  @if (projectsService.isLoading()) {
    <app-loading-spinner [overlay]="true" message="èª­ã¿è¾¼ã¿ä¸­..." />
  }

  <!-- ã‚¨ãƒ©ãƒ¼ -->
  @if (projectsService.error()) {
    <div class="project-list__error">
      <p>{{ projectsService.error() }}</p>
      <button type="button" class="project-list__retry-btn" (click)="projectsService.loadProjects()">
        å†è©¦è¡Œ
      </button>
    </div>
  }

  <!-- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ -->
  @if (!projectsService.isLoading() && !projectsService.error()) {
    @if (projectsService.projects().length === 0) {
      <div class="project-list__empty">
        <p>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒã‚ã‚Šã¾ã›ã‚“</p>
        <p class="project-list__empty-hint">ã€Œæ–°è¦ä½œæˆã€ãƒœã‚¿ãƒ³ã‹ã‚‰ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„</p>
      </div>
    } @else {
      <div class="project-list__grid">
        @for (project of projectsService.projects(); track project.id) {
          <div class="project-card">
            <div class="project-card__header">
              <h2 class="project-card__name">{{ project.name }}</h2>
              <div class="project-card__actions">
                <button
                  type="button"
                  class="project-card__edit-btn"
                  (click)="openEditDialog(project)"
                  aria-label="ç·¨é›†"
                >
                  âœï¸
                </button>
                <button
                  type="button"
                  class="project-card__delete-btn"
                  (click)="openDeleteConfirm(project)"
                  aria-label="å‰Šé™¤"
                >
                  ğŸ—‘ï¸
                </button>
              </div>
            </div>

            <p class="project-card__description">
              {{ project.description || 'èª¬æ˜ãªã—' }}
            </p>

            <div class="project-card__footer">
              <span class="project-card__owner">{{ project.ownerName }}</span>
              <span class="project-card__date">{{ project.createdAt | date:'yyyy/MM/dd' }}</span>
            </div>
          </div>
        }
      </div>

      <!-- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ -->
      @if (projectsService.totalPages() > 1) {
        <app-pagination
          [currentPage]="projectsService.currentPage()"
          [totalPages]="projectsService.totalPages()"
          (pageChange)="onPageChange($event)"
        />
      }
    }
  }

  <!-- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ/ç·¨é›†ãƒ€ã‚¤ã‚¢ãƒ­ã‚° -->
  @if (isDialogOpen()) {
    <app-project-dialog
      [mode]="dialogMode()"
      [project]="editingProject()"
      (save)="onSave($event)"
      (cancel)="closeDialog()"
    />
  }

  <!-- å‰Šé™¤ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚° -->
  <app-confirm-dialog
    [isOpen]="isConfirmDialogOpen()"
    type="danger"
    title="ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å‰Šé™¤"
    [message]="'ã€Œ' + (deletingProject()?.name || '') + 'ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ'"
    confirmText="å‰Šé™¤"
    cancelText="ã‚­ãƒ£ãƒ³ã‚»ãƒ«"
    (confirm)="onConfirmDelete()"
    (cancel)="closeDeleteConfirm()"
  />
</div>
