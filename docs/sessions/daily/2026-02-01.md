# 2026-02-01 セッション記録

## セッション概要

| 項目 | 内容 |
|------|------|
| 目的 | Issue #6対応、Sandbox設定 |
| 作業特性 | 機能拡張 / 環境設定 |

## 完了事項

- [x] **Issue #6: Playwright MCPをSkills + CLIに置き換え**
  - `.mcp.json` 削除（Playwright MCP設定）
  - `docs/adr/0006-playwright-e2e-auth-only.md` 修正（MCP記載削除、CLI実行手順追加）
  - `docs/design/angular-architecture.md` 修正（MCP連携セクションをCLI実行に置き換え）
  - Issue #6クローズ

- [x] **CLAUDE.md修正**
  - WSL環境移行に伴い、docker exec形式の注意書きを削除
  - ファイル操作は直接実行可能、npm/nodeコマンドはDevContainer内で実行

- [x] **Sandboxモード有効化**
  - 依存関係インストール（bubblewrap, socat, @anthropic-ai/sandbox-runtime）
  - Sandboxモードの選択肢（auto-allow vs regular permissions）の説明

## 技術的知見・学び

- **Sandboxモードの選択肢**:
  - `auto-allow`: サンドボックス内コマンドは自動実行、制限突破時のみ確認
  - `regular permissions`: 全コマンドでユーザー確認を求める
  - 通常はauto-allowで十分（サンドボックスが安全な範囲を保証）

- **WSL環境でのClaude Code**:
  - ファイル操作（Read/Edit/Write/Glob/Grep）: 直接実行可能
  - npm/nodeコマンド: DevContainer内で実行が必要

## 発生した問題と解決

### 問題1: E2Eテスト実行時にPlaywrightブラウザが見つからない
- **原因**: Playwright Chromiumがインストールされていなかった
- **解決策**: `npx playwright install chromium`でブラウザをインストール

### 問題2: E2Eテストが一部失敗
- **原因**: バックエンドサービス（BFF）が起動していない状態でテスト実行
- **解決策**: バックエンドサービス起動後にテスト実行が必要（想定通りの動作）

## 未完了・継続事項

なし（本セッションの目的は全て達成）

## 次回への申し送り

- Sandboxモードが有効化された状態でClaude Codeを使用可能
- E2Eテスト実行時はバックエンドサービス（task-service, user-service, api-gateway）の起動が必要
